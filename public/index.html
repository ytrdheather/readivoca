<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Readitude Voca</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <!-- 1. 로그인 -->
        <div id="login-section">
            <h2 style="color:#32bfb6"><i class="fa-solid fa-graduation-cap"></i> Readitude</h2>
            <input type="text" id="username" placeholder="아이디">
            <input type="password" id="password" placeholder="비밀번호">
            <button class="btn-primary" onclick="login()">로그인</button>
        </div>

        <!-- 2. 교재 선택 -->
        <div id="selection-section" class="hidden">
            <h2 id="welcome-msg" style="color:#32bfb6">환영합니다!</h2>
            <select id="book-select" onchange="loadUnits()"><option value="">📚 교재 선택</option></select>
            <select id="unit-select" disabled><option value="">📂 유닛 선택</option></select>
            <button class="btn-primary" onclick="goToDashboard()">학습 대시보드로 이동 🚀</button>
        </div>

        <!-- 3. 대시보드 -->
        <div id="dashboard-section" class="hidden">
            <h3 id="dash-unit-title">Unit Name</h3>
            <div class="menu-grid">
                <div class="menu-card" onclick="startFlashcard()"><i class="fa-solid fa-layer-group"></i><h3>1. 암기</h3></div>
                <div class="menu-card" onclick="startSpelling()"><i class="fa-solid fa-keyboard"></i><h3>2. 스펠링</h3></div>
                <div class="menu-card" onclick="startContextQuiz()"><i class="fa-solid fa-rotate"></i><h3>3. 반복</h3></div>
                <div class="menu-card" onclick="startTest()"><i class="fa-solid fa-file-signature"></i><h3>4. 테스트</h3></div>
            </div>
            <button class="btn-game" onclick="showGameZone()"><i class="fa-solid fa-gamepad"></i> GAME ZONE (쉬는 시간)</button>
            <button class="btn-secondary" onclick="goBackToSelection()">교재 변경</button>
        </div>

        <!-- 4. 플래시카드 -->
        <div id="flashcard-section" class="hidden">
            <div class="card-container" onclick="flipCard()">
                <div class="card" id="flashcard">
                    <div class="card-face front"><span id="fc-en"></span></div>
                    <div class="card-face back">
                        <button class="audio-btn" onclick="event.stopPropagation(); playAudio()"><i class="fa-solid fa-volume-high"></i></button>
                        <div class="meaning-text" id="fc-ko"></div>
                        <div class="info-box" id="fc-ex"><span class="info-label">EXAMPLE</span><span id="fc-ex-text"></span></div>
                        <div class="info-box" id="fc-syn"><span class="info-label">SYNONYMS</span><span id="fc-syn-text"></span></div>
                        <div class="info-box" id="fc-ant"><span class="info-label">ANTONYMS</span><span id="fc-ant-text"></span></div>
                    </div>
                </div>
            </div>
            <div style="display:flex; justify-content:center; gap:10px;">
                <button class="btn-primary" style="width:120px" onclick="prevCard()">이전</button>
                <button class="btn-primary" style="width:120px" onclick="nextCard()">다음</button>
            </div>
            <button class="btn-secondary" onclick="backToDashboard()">나가기</button>
        </div>

        <!-- 5. 스펠링 -->
        <div id="spelling-section" class="hidden">
            <div class="score-board">점수: <span id="spell-score">0</span></div>
            <div class="question-box" id="spell-meaning"></div>
            <div class="hint-text" id="spell-hint"></div>
            <input type="text" id="spell-input" placeholder="정답 입력" autocomplete="off">
            <button class="btn-primary" onclick="checkSpelling()">확인</button>
            <p id="spell-feedback"></p>
            <button class="btn-secondary" onclick="backToDashboard()">그만하기</button>
        </div>

        <!-- 5-1. 스펠링 결과 -->
        <div id="spelling-result-section" class="hidden">
            <h3>스펠링 학습 완료! 🎉</h3>
            <div style="font-size:1.5rem;">내 점수: <span id="spell-final-score" style="color:#32bfb6;">0</span>점</div>
            <div id="spell-submit-box" class="submit-confirm-box">
                <h4>📝 기록 제출 확인</h4>
                <span id="spell-submit-msg" class="submit-msg"></span>
                <button id="spell-submit-btn" class="btn-primary" onclick="submitCurrentRecord()">네! 제출할게요</button>
                <button class="btn-secondary" onclick="startRetrySpelling()">다시 연습할래요</button>
            </div>
            <div id="spell-wrong-list-area" class="hidden">
                <h4>❌ 틀린 단어 리스트</h4>
                <div id="spell-wrong-word-list" class="wrong-list-container"></div>
            </div>
            <button class="btn-secondary" onclick="backToDashboard()">대시보드로</button>
        </div>

        <!-- 6. 반복 훈련 -->
        <div id="quiz-section" class="hidden">
            <div class="score-board" id="quiz-progress">1 / 50</div>
            <div class="question-box" id="quiz-question"></div>
            <div class="hint-text" id="quiz-type-badge"></div>
            <div class="option-grid" id="quiz-options"></div>
            <button class="btn-secondary" onclick="backToDashboard()">그만하기</button>
        </div>

        <!-- 6-1. 반복 훈련 결과 -->
        <div id="quiz-result-section" class="hidden">
            <h3>반복 훈련 완료! 🏆</h3>
            <div style="font-size:1.5rem;">내 점수: <span id="quiz-final-score" style="color:#32bfb6;">0</span>점</div>
            <div id="quiz-submit-box" class="submit-confirm-box">
                <h4>📝 기록 제출 확인</h4>
                <span id="quiz-submit-msg" class="submit-msg"></span>
                <button id="quiz-submit-btn" class="btn-primary" onclick="submitCurrentRecord()">네! 제출할게요</button>
                <button class="btn-secondary" onclick="startRetryQuiz()">다시 연습할래요</button>
            </div>
            <div id="quiz-wrong-list-area" class="hidden">
                <h4>❌ 틀린 문제 리스트</h4>
                <div id="quiz-wrong-word-list" class="wrong-list-container"></div>
            </div>
            <button class="btn-secondary" onclick="backToDashboard()">대시보드로</button>
        </div>

        <!-- 7. 선생님 관리 -->
        <div id="teacher-section" class="hidden">
            <h2 style="color:#32bfb6">👨‍🏫 선생님 모드</h2>
            <select id="teacher-book-select" onchange="renderTeacherTable()"></select>
            <table class="teacher-table">
                <thead><tr><th>학생명</th><th>유닛</th><th>진행률</th><th>점수</th><th>완료일</th></tr></thead>
                <tbody id="teacher-tbody"></tbody>
            </table>
            <button class="btn-secondary" onclick="logout()">로그아웃</button>
        </div>

        <!-- 8. 게임존 메뉴 -->
        <div id="game-menu-section" class="hidden">
            <h2 style="color:#ff9800">🎮 GAME ZONE</h2>
            <div class="menu-grid">
                <div class="menu-card" onclick="startMemoryGame()" style="border-color:#ff9800;"><i class="fa-solid fa-clone" style="color:#ff9800;"></i><h3>카드 짝맞추기</h3></div>
                <div class="menu-card" onclick="startWordRain()" style="border-color:#2196f3;"><i class="fa-solid fa-cloud-rain" style="color:#2196f3;"></i><h3>단어 산성비</h3></div>
            </div>
            <button class="btn-secondary" onclick="backToDashboard()">대시보드로 돌아가기</button>
        </div>

        <!-- 9. 카드 게임 -->
        <div id="memory-game-section" class="hidden">
            <h3 style="color:#ff9800">🃏 Memory Match</h3>
            <div style="display:flex; justify-content:space-between; padding:0 20px;"><span>Time: <b id="mem-time">60</b>s</span> <span>Score: <b id="mem-score">0</b></span></div>
            <div class="memory-game-grid" id="memory-grid"></div>
            <!-- 여기 수정됨: 게임 종료 버튼이 backToDashboard 호출 -->
            <button class="btn-secondary" onclick="backToDashboard()">나가기</button>
        </div>

        <!-- 10. 산성비 게임 -->
        <div id="word-rain-section" class="hidden">
            <h3 style="color:#2196f3">🌧️ Word Rain</h3>
            <div style="display:flex; justify-content:space-between; padding:0 20px;"><span>Life: <b id="rain-life">❤️❤️❤️</b></span> <span>Score: <b id="rain-score">0</b></span></div>
            <div id="rain-canvas-container"></div>
            <div class="rain-input-area"><input type="text" id="rain-input" placeholder="단어 입력" autocomplete="off"></div>
            <!-- 여기 수정됨: 게임 종료 버튼이 backToDashboard 호출 -->
            <button class="btn-secondary" onclick="backToDashboard()">나가기</button>
        </div>

        <!-- 11. 게임 결과 -->
        <div id="game-result-section" class="hidden">
            <h2 id="game-result-title">Game Over!</h2>
            <h1 id="game-final-score" style="font-size:3rem; color:#ff9800;">0</h1>
            <div class="ranking-list"><h4>🏆 명예의 전당</h4><div id="ranking-container">Loading...</div></div>
            <button class="btn-secondary" onclick="showGameZone()">다시 하기</button>
            <button class="btn-secondary" onclick="backToDashboard()">대시보드로</button>
        </div>

    </div>
    <script src="script.js"></script>
</body>
</html>